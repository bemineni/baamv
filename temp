
<a href="#myModal" onClick='change_display()' role="button" class="btn" data-toggle="modal"><%= image_tag image.file_url(:thumb).to_s %></a>

application.html.erb

<!doctype html>
<html class="no-js" lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title><%= getTitle(content_for(:title)) %></title>
  <meta name="description" content="">
  <meta name="author" content="">

  <meta name="viewport" content="width=device-width">
 
  <%= stylesheet_link_tag    "application", :media => "all" %>
  <%= javascript_include_tag "application" %>
  <%= javascript_include_tag 'modernizr' %>

  <%= csrf_meta_tags %>
</head>
<body>
<%= render 'common/modal_dialog' %>
<%= render 'layouts/header' %>
<div class="container" style="min-height:500px;">
   <% flash.each do |key, value| %>
        <div class="alert alert-<%= key %>"><%= value %></div>
   <% end %>
   <%= yield %>   
</div>
<%= render 'layouts/footer' %>
<%= debug(params) if Rails.env.development? %>
<script>
  var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>

</body>
</html>


_header.html.erb

 <div> 
  <li><%= link_to "Home" , root_path %></li>
  <% if is_signedin? %>
        <li class="active"> <%= link_to "Login",login_path %></li>
  <% else %>
        <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#"><%= "#{current_user.username}" %><span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><%= link_to "Account details", current_user %></li>
            <li class="divider"></li>
            <li><%= link_to "Log out", logout_path, :method => :delete%></li>
        </ul>
        </li>
  <% end %>
</div>


blog.html.erb
/***********************************************Old 
<div>
  <div><h3> <%= blog.title %></h3></div>
  <hr/>
  <div>
    <%= RedCloth.new(codeHighlight(blog.body)).to_html.html_safe %>
  </div>
  
  <% if blog.images.all.count > 0 %>
  <hr/>
  <div>
    <h5>Images</h5>
    <% blog.images.all.each do |image| %>
        <%= link_to (image_tag image.file_url(:thumb).to_s ,:class=>"img-polaroid") , "baamvdialog", :class => 'dialogopener' ,:data=>{:src=>image.file_url(:show).to_s} %>
        
    <% end %> 
  </div>
    <% end %>
    <hr/>
  <% if blog.attachments.all.count > 0 %>
  <div>
    <h5>Attachements</h5>
    <% blog.attachments.all.each do |attachment| %>
        <%= link_to File.basename(attachment.file_url.to_s), attachment.file_url.to_s %>
    <% end %> 
  </div>
    <hr/>
    <% end %>
  <div>
    <div>
      <% if current_user?(blog.user) %>
        <%= link_to "Edit blog", edit_blog_path(blog) ,:class => "btn btn-primary"%>
      <% end %>
    </div>
    <div>
      <h5><%= blog.user.username %></h5>
      <h5><%= blog.created_at %></h5>
    </div>
  </div>
</div>

home.html.erb
<div >
  <div >
      
  </div>
  
  <div id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div >
    <button type="button" data-dismiss="modal" aria-hidden="true">Ã—</button>
    </div>
    <div class="modal-body">

        <img id="image-id" src="">
    </div>
    <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    <button class="btn btn-primary">Save changes</button>
    </div>
  </div>
  <div class="well span3">
    <% if !is_signedin? %>
      <%= link_to "Post new blog", new_blog_path ,:class => "btn btn-primary"%>
    <% end %>
    <div> Other suggestions go here </div>
  </div>
</div>



def change
    create_table :users do |t|

      t.string :username
      t.string :firstname
      t.string :lastname
      t.string :initial
      t.string :sex
      t.text   :address
      t.string :city
      t.integer :state_id
      t.integer :country_id
      t.string :zip
      t.string :email
      t.string :phone
      t.string :mobile
      t.string :verify_key
      t.string :remember_token
      t.string :password_digest

      t.timestamps
    end

    add_index :users, :username, :unique => true 
    add_index :users, :email , :unique => true


    class User < ActiveRecord::Base
   attr_accessible :username, :firstname,:lastname,:initial,:sex,:address,:city,:state_id,
                   :country_id ,:zip,:email,:phone,:mobile,:password,:password_confirmation,
                   :verify_key ,:remember_token
   belongs_to :country
   belongs_to :state 
   has_many :blogs , :foreign_key => :author, :dependent => :destroy

   has_secure_password

   before_save { |user| user.email = email.downcase }
   before_save :create_verify_key
   before_save :create_remember_token

   USERNAME_REGEX = /^[a-zA-Z0-9]+$/i
   validates :username, :presence => true, :length => { :maximum => 15 } , :format => { :with => USERNAME_REGEX }
   validates :firstname, :presence => true, :length => { :maximum => 20 }
   validates :lastname, :presence => true, :length => { :maximum => 20 }
   SEX_REGEX = /^(male|female)$/i
   validates :sex, :presence => true, :length => { :maximum => 6 }, :format => { :with => SEX_REGEX }
   validates :city, :presence => true
   validates :state_id, :presence => true
   validates :country_id, :presence => true
   VALID_EMAIL_REGEX = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i
   validates :email,:presence  => true ,:format => {:with => VALID_EMAIL_REGEX },:uniqueness => { :case_sensitive => false} 
   validates :password, :presence => true,:length => {:minimum => 6 } , :on => :create
   validates :password_confirmation, :presence => true, :on => :create
   
private

   def create_verify_key
      if self.verify_key != "0"
         self.verify_key = Digest::MD5.hexdigest("#{self.email}#{self.firstname}#{self.lastname}")
      end
   end

   def create_remember_token
      self.remember_token = SecureRandom.urlsafe_base64
   end
   
end